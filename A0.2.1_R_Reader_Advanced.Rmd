---
title: "R Stream of Decision Modelling for Health Economic Evaluation Reader - Advanced Course"
author: "Nichola Naylor & Jack Williams"
date: "May/June 2021 Course"
output: html_document
#  pdf_document: default
#  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Course Reader 

Text about the course generally & R resouces:

I wonder if there is some generic text we can find for the course (?)

\  

## R project and working directory

\  

#### Opening an R project 

Something about R projects here 

\  

#### Working directory

If you download the course material using the R project, then the working directory will automatically be set to the folder where the project is. 

If you want to manually set the working directory, then you can use the setwd() function, or alternatively, if you want to set the working directory automatically to the folder your are currently in, you can run the following code: 
```{r, eval = FALSE} 
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```

\  

## Installing packages 

Although within the course we try to mostly use base R functions, we will need to use packages for some exercises. 

The following packages are used in the course and can be installed using the following code. 

```{r, eval = FALSE} 
install.packages(tidyr)
install.packages(dplyr)
install.packages(data.table)
install.packages(ggplot2)
install.packages(reshape2)
```

\  

## Key Base R functions (what do we want to add here? Could be a bit tedious...?)

We will use many base R functions throughout the course. You can see a simple cheat sheet here:
https://www.rstudio.com/wp-content/uploads/2016/10/r-cheat-sheet-3.pdf 


**Vector**
```{r, echo=TRUE}
(vector <- c(1, 2, 3))
```


**Matrix**
```{r, echo=TRUE}
matrix(1:9, nrow = 3, ncol = 3)
```


**Data frame (combining different classes of data)**
```{r, echo=TRUE}

tx <- c("No treatment", "Treatment 1", "Treatment 2", "Treatment 3")
cost <- c(0, 500, 1500, 7500)
duration.months <- c(0, 1, 1, 0.5)

data.frame(tx, cost, duration.months)
```


**Array (a multi-dimenesional matrix) - the dim (dimensions) aspects indicates rows, columns, matrix numbers**
```{r, echo=TRUE}
array(1:18, dim = c(3, 3, 2))

array(1:16, dim = c(2, 2, 3))

```

\  

## Subsetting and selecting data 

Another important aspect of the course is selecting the appropraite data. For the various vectors, data frames and arrays, here are some selections of data


**Vector**
```{r, echo=TRUE}

(vector <- c(10, 20, 30, 40))
vector[2] # Takes the second element of the vector
vector[3:4] # Takes the third and fourth element of the vector

```
**Data frame**
```{r, echo=TRUE}  
df <- data.frame(tx, cost, duration.months)
print(df)
df[3,] # Third row (all columns)
df[,2] # Second column (all rows)
df[3,2] # Third row and second column value

df$cost # We can also call columns by their column name 
```
**Array**
```{r, echo=TRUE}  
ar <- array(1:18, dim = c(3, 3, 2))
print(ar)
ar[1,,2] # first row, of second matrix
ar[,,1] # All rows, all columns, first matrix

```
\  

## Probabilistic modelling and sampling from random draws

In module X we will learn about probabilistic modelling, to account for parameter uncertainty in decision models. 

We show some examples of sampling using the normal distribution, beta distribution, and gamma distribution. We run 8 samples of each, but this could be set to any number. 

```{r, echo=TRUE}

# Normal distribution with mean of 20 and standard deviation of 4 
rnorm(n = 8, mean = 20, sd = 4)

# Beta distribution of probability of 0.05 (1 event out of 20 subjects)
rbeta(n = 8, shape1 = 1, shape2 = 19)

# Gamma gistribution for mean of 1000 and SE of 200 
rgamma(n = 8, shape = 25, scale = 40)

```
\  

## Direct to DART materials - Nichola to add

Nichola to add

\  

## Plots 

In the course we will use a mixture of base R plots and plots using a package called ggplot. 

The base R plots are simple to create and provide an easy way to look at the data. 

ggplot is a much more flexible package that has many more options within plots. This allows the user to edit every aspects of the plot to get it exaclty how they want it. Whilst this is really helpful for data visualisation and producing great plots, hte number of options are extensive and we won't have time to cover them in any detail in this course. 

For those interested in learning more about ggplot, there is an excellent chapter on data visualiation chapter in the 'R for Data Science'  book, available here: 
https://r4ds.had.co.nz/data-visualisation.html

\  

